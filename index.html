<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pibe Tips Pro - Over 2.5 Goles</title>
  <style>
    body { margin:0; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background:#020617; color:#e5e7eb; }
    header { padding:16px 20px; background:#0f172a; border-bottom:1px solid #1f2937; display:flex; flex-direction:column; gap:4px; }
    .title { font-size:20px; font-weight:700; color:#22d3ee; }
    .subtitle { font-size:12px; color:#9ca3af; }
    .bank { font-size:12px; color:#fbbf24; }
    main { padding:16px 12px 40px; max-width:900px; margin:0 auto; }
    .top-bar { display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin-bottom:12px; }
    select, button { font-size:13px; border-radius:999px; border:1px solid #1f2937; padding:8px 14px; background:#020617; color:#e5e7eb; }
    button { background:#22c55e; border-color:#16a34a; font-weight:600; cursor:pointer; }
    button:hover { background:#16a34a; }
    .chips { display:flex; gap:6px; flex-wrap:wrap; font-size:11px; }
    .chip { padding:4px 10px; border-radius:999px; border:1px solid #1f2937; color:#9ca3af; cursor:pointer; }
    .chip.active { background:#22d3ee22; color:#22d3ee; border-color:#22d3ee55; }
    .card { background:#020617; border-radius:14px; padding:12px 14px; margin-bottom:10px; border:1px solid #1f2937; box-shadow:0 10px 30px rgba(0,0,0,0.45); }
    .card-header { display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .match { font-weight:600; font-size:14px; }
    .league { font-size:11px; color:#9ca3af; }
    .pill { font-size:11px; padding:4px 8px; border-radius:999px; background:#0f172a; color:#e5e7eb; }
    .prob-row { margin-top:8px; display:flex; justify-content:space-between; font-size:11px; align-items:center; }
    .prob-bar { margin-top:4px; width:100%; height:6px; border-radius:999px; background:#111827; overflow:hidden; }
    .prob-fill { height:100%; border-radius:999px; background:linear-gradient(90deg,#22c55e,#22d3ee); }
    .grid { display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:8px; margin-top:10px; font-size:11px; }
    .label { color:#6b7280; font-size:10px; text-transform:uppercase; letter-spacing:0.06em; }
    .value { font-size:11px; }
    .analysis { margin-top:8px; font-size:11px; color:#d1d5db; }
    .footer { margin-top:8px; display:flex; justify-content:space-between; font-size:11px; color:#9ca3af; }
    .loading { text-align:center; padding:20px; color:#9ca3af; }
    .error { color:#ff4757; padding:16px; }
    @media (max-width:600px){ .grid{grid-template-columns:1fr;} }
  </style>
</head>
<body>
  <header>
    <div class="title">PIBE TIPS PRO ¬∑ Over 2.5 Goles</div>
    <div class="subtitle">Pron√≥sticos profesionales con bajas, urgencia y valor real</div>
    <div class="bank">Bankroll: 7000 Bs ¬∑ Stake sugerido: 105 Bs (1.5% por pick) ¬∑ Hit rate hist√≥rico: 72%</div>
  </header>
  <main>
    <div class="top-bar">
      <label style="font-size:12px; color:#9ca3af;">Fecha:
        <select id="dateFilter">
          <option value="">Todas las fechas</option>
        </select>
      </label>
      <button onclick="loadData()">üéØ Generar pron√≥sticos Over 2.5</button>
    </div>
    <div class="chips">
      <div class="chip active">Prob ‚â• 75%</div>
      <div class="chip">Prob ‚â• 80%</div>
      <div class="chip">Solo Europa League</div>
    </div>
    <div id="cardsContainer" class="loading">Cargando pron√≥sticos...</div>
  </main>

  <script>
    const SHEET_ID = '1MBb556CHr5whndg-f8EHp2eUtoJnoDJKnDdW_nWhw0c';
    const API_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/query?key=AIzaSyDaRkWdGEf9oBLariATnysJtBJNCLXYfIE`;
    
    let allData = [];

    async function loadData() {
      try {
        const response = await fetch(API_URL + `&tq=SELECT *`);
        const text = await response.text();
        const json = JSON.parse(text.substring(6));
        
        if (json.rows.length === 0) {
          document.getElementById('cardsContainer').innerHTML = '<div class="error">No hay datos disponibles</div>';
          return;
        }

        allData = json.rows.map(row => ({
          fecha: row.c[0]?.v || '',
          partido: row.c[1]?.v || '',
          liga: row.c[2]?.v || '',
          hora: row.c[3]?.v || '',
          cuota: row.c[4]?.v || '',
          casa: row.c[5]?.v || '',
          probabilidad: row.c[6]?.v || '',
          stake: row.c[7]?.v || '',
          retorno: row.c[8]?.v || '',
          analisis: row.c[9]?.v || '',
          bajas: row.c[10]?.v || '',
          contexto: row.c[11]?.v || ''
        })).filter(row => row.fecha && row.partido && !isNaN(row.probabilidad));

        // Llenar selector de fechas
        const uniqueDates = [...new Set(allData.map(d => d.fecha))].sort().reverse();
        const dateFilter = document.getElementById('dateFilter');
        dateFilter.innerHTML = '<option value="">Todas las fechas</option>';
        uniqueDates.forEach(date => {
          const option = document.createElement('option');
          option.value = date;
          option.textContent = date;
          dateFilter.appendChild(option);
        });

        renderCards();
      } catch (error) {
        document.getElementById('cardsContainer').innerHTML = '<div class="error">Error al cargar datos: ' + error.message + '</div>';
      }
    }

    function renderCards() {
      const selectedDate = document.getElementById('dateFilter')?.value || '';
      const filteredData = selectedDate ? allData.filter(d => d.fecha === selectedDate) : allData;

      if (filteredData.length === 0) {
        document.getElementById('cardsContainer').innerHTML = '<div class="loading">No hay pron√≥sticos para esta fecha</div>';
        return;
      }

      let html = '';
      filteredData.forEach((pred, index) => {
        const prob = parseInt(pred.probabilidad) || 0;
        const emojis = pred.liga.includes('Europa') ? 'üá™üá∫' : pred.liga.includes('LaLiga') ? 'üá™üá∏' : pred.liga.includes('Liga') ? 'üèÜ' : '‚öΩ';
        
        html += `
          <section class="card">
            <div class="card-header">
              <div>
                <div class="match">${pred.partido} ${emojis}</div>
                <div class="league">${pred.liga} ¬∑ ${pred.hora}</div>
              </div>
              <div style="text-align:right;">
                <div class="pill">Over 2.5 goles</div>
                <div style="font-size:11px; margin-top:4px;">Cuota ${pred.cuota} ¬∑ ${pred.casa}</div>
              </div>
            </div>
            <div class="prob-row">
              <span>Probabilidad estimada: <strong>${prob}%</strong></span>
              <span>Stake ${pred.stake} Bs ‚Üí Retorno ${pred.retorno} Bs</span>
            </div>
            <div class="prob-bar"><div class="prob-fill" style="width:${prob}%"></div></div>
            <div class="grid">
              <div>
                <div class="label">Bajas clave</div>
                <div class="value">${pred.bajas || 'Sin informaci√≥n'}</div>
              </div>
              <div>
                <div class="label">Contexto</div>
                <div class="value">${pred.contexto || 'Sin informaci√≥n'}</div>
              </div>
            </div>
            <div class="analysis">${pred.analisis || 'Sin an√°lisis disponible'}</div>
            <div class="footer">
              <span>Confianza: ${prob >= 80 ? 'Muy Alta üî•' : prob >= 75 ? 'Alta üî•' : 'Media'}</span>
              <span>${index + 1} de ${filteredData.length}</span>
            </div>
          </section>
        `;
      });

      document.getElementById('cardsContainer').innerHTML = html;
    }

    document.getElementById('dateFilter').addEventListener('change', renderCards);
    loadData();
  </script>
</body>
</html>

